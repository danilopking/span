<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Job Design Spans</title>
  <style>
    :root{
      --bg:#f3f4f6;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --line:#6b7280;
      --accent:#b91c1c;
      --ok:#065f46;
      --okbg:#d1fae5;
      --warn:#92400e;
      --warnbg:#ffedd5;
      --border:#e5e7eb;
    }
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
    }
    .wrap{ max-width: 820px; margin: 0 auto; padding: 18px; }
    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(0,0,0,.06);
    }
    h1{ font-size: 18px; margin: 0 0 8px 0; }
    .hint{ color: var(--muted); font-size: 13px; margin-bottom: 12px; }
    .rows{ position: relative; padding: 8px 0 0 0; }
    .row{
      display: grid;
      grid-template-columns: 170px 1fr 40px;
      gap: 12px;
      align-items: center;
      padding: 12px 0;
    }
    .label{
      font-size: 14px;
      font-weight: 600;
    }
    .sub{
      display:flex;
      justify-content: space-between;
      color: var(--muted);
      font-size: 12px;
      margin-top: 4px;
    }
    input[type="range"]{ width:100%; }
    .val{
      width: 40px;
      height: 34px;
      display:flex;
      align-items:center;
      justify-content:center;
      border: 1px solid var(--border);
      border-radius: 10px;
      font-weight: 700;
      background: #fafafa;
    }

    /* Overlay SVG for the connecting polyline */
    .overlay{
      position:absolute;
      left: 170px;   /* starts where sliders start */
      right: 52px;   /* stops before the value boxes */
      top: 0;
      bottom: 0;
      pointer-events:none;
    }

    .gapbar{
      display:flex;
      align-items:center;
      gap: 10px;
      margin: 10px 0 0 0;
    }
    .gaplabel{
      color: var(--accent);
      font-weight: 700;
      font-size: 13px;
      white-space: nowrap;
    }
    .gapval{
      font-weight: 800;
      color: var(--accent);
    }
    .gapline{
      height: 2px;
      background: var(--accent);
      flex:1;
      border-radius: 999px;
      position: relative;
    }
    .gapline:before, .gapline:after{
      content:"";
      position:absolute;
      top: 50%;
      width: 0;
      height: 0;
      border-top: 6px solid transparent;
      border-bottom: 6px solid transparent;
      transform: translateY(-50%);
    }
    .gapline:before{ left: -2px; border-right: 10px solid var(--accent); }
    .gapline:after{ right: -2px; border-left: 10px solid var(--accent); }

    .status{
      margin-top: 14px;
      padding: 12px 14px;
      border-radius: 12px;
      font-weight: 700;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .status.ok{ background: var(--okbg); color: var(--ok); }
    .status.warn{ background: var(--warnbg); color: var(--warn); }
    .small{
      font-size: 12px;
      font-weight: 600;
      color: var(--muted);
      margin-top: 6px;
    }

    /* Make it embed-friendly */
    @media (max-width: 640px){
      .row{ grid-template-columns: 1fr; }
      .overlay{ display:none; } /* overlay is fiddly on tiny widths, so hide it */
      .val{ width: 100%; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Job Design Spans</h1>
      <div class="hint">Move sliders. The line shows how the job “connects”. Because humans love visual guilt.</div>

      <div class="rows" id="rows">
        <svg class="overlay" id="overlaySvg" viewBox="0 0 100 100" preserveAspectRatio="none">
          <polyline id="poly" fill="none" stroke="var(--line)" stroke-width="1.8" points=""></polyline>
          <circle id="c1" r="1.6" fill="var(--line)"></circle>
          <circle id="c2" r="1.6" fill="var(--line)"></circle>
          <circle id="c3" r="1.6" fill="var(--line)"></circle>
          <circle id="c4" r="1.6" fill="var(--line)"></circle>
        </svg>

        <div class="row" data-key="control">
          <div>
            <div class="label">Span of Control</div>
            <div class="sub"><span>Few resources</span><span>Many resources</span></div>
          </div>
          <input type="range" min="1" max="10" value="3" step="1" />
          <div class="val">3</div>
        </div>

        <div class="row" data-key="accountability">
          <div>
            <div class="label">Span of Accountability</div>
            <div class="sub"><span>Few trade-offs</span><span>Many trade-offs</span></div>
          </div>
          <input type="range" min="1" max="10" value="8" step="1" />
          <div class="val">8</div>
        </div>

        <div class="row" data-key="influence">
          <div>
            <div class="label">Span of Influence</div>
            <div class="sub"><span>Within unit</span><span>Across units</span></div>
          </div>
          <input type="range" min="1" max="10" value="2" step="1" />
          <div class="val">2</div>
        </div>

        <div class="row" data-key="support">
          <div>
            <div class="label">Span of Support</div>
            <div class="sub"><span>No help</span><span>Others help</span></div>
          </div>
          <input type="range" min="1" max="10" value="5" step="1" />
          <div class="val">5</div>
        </div>
      </div>

      <div class="gapbar" title="Simple: Accountability - Control">
        <div class="gaplabel">Entrepreneurial Gap</div>
        <div class="gapline"></div>
        <div class="gapval" id="gapVal">+5</div>
      </div>

      <div class="status ok" id="statusBox">
        <span id="statusIcon">✓</span>
        <span id="statusText">This job is balanced.</span>
      </div>
      <div class="small" id="ruleNote">
        Rule: “balanced” if max difference between spans ≤ 3 (change in code if you want).
      </div>
    </div>
  </div>

<script>
  const rows = [...document.querySelectorAll(".row")];
  const svg = document.getElementById("overlaySvg");
  const poly = document.getElementById("poly");
  const circles = [1,2,3,4].map(i => document.getElementById("c"+i));
  const gapVal = document.getElementById("gapVal");
  const statusBox = document.getElementById("statusBox");
  const statusIcon = document.getElementById("statusIcon");
  const statusText = document.getElementById("statusText");

  // tweak this threshold to your taste
  const BALANCE_THRESHOLD = 3;

  function getValues(){
    const map = {};
    rows.forEach(r => {
      const key = r.dataset.key;
      const input = r.querySelector('input[type="range"]');
      map[key] = parseInt(input.value, 10);
    });
    return map;
  }

  function updateValueBoxes(){
    rows.forEach(r => {
      const input = r.querySelector('input[type="range"]');
      r.querySelector(".val").textContent = input.value;
    });
  }

  function setSvgViewBox(){
    // keep overlay viewBox at 100x100 for easy percent mapping
    svg.setAttribute("viewBox", "0 0 100 100");
  }

  function sliderToPercent(v){
    // v is 1..10 => 0..100
    return ((v - 1) / 9) * 100;
  }

  function updatePolyline(){
    // map each row to a y position in SVG percent space
    const total = rows.length;
    const yStep = 100 / (total + 1);
    const vals = getValues();
    const order = ["control","accountability","influence","support"];

    const points = order.map((k, idx) => {
      const x = sliderToPercent(vals[k]);
      const y = (idx + 1) * yStep;
      return {x, y};
    });

    poly.setAttribute("points", points.map(p => `${p.x},${p.y}`).join(" "));
    points.forEach((p, i) => {
      circles[i].setAttribute("cx", p.x);
      circles[i].setAttribute("cy", p.y);
    });
  }

  function updateGapAndStatus(){
    const v = getValues();
    const gap = v.accountability - v.control; // simple version
    gapVal.textContent = (gap >= 0 ? "+" : "") + gap;

    const arr = Object.values(v);
    const max = Math.max(...arr);
    const min = Math.min(...arr);
    const spread = max - min;

    if (spread <= BALANCE_THRESHOLD){
      statusBox.classList.remove("warn");
      statusBox.classList.add("ok");
      statusIcon.textContent = "✓";
      statusText.textContent = "This job is balanced.";
    } else {
      statusBox.classList.remove("ok");
      statusBox.classList.add("warn");
      statusIcon.textContent = "⚠";
      statusText.textContent = "This job looks unbalanced (spans are too far apart).";
    }
  }

  function updateAll(){
    updateValueBoxes();
    setSvgViewBox();
    updatePolyline();
    updateGapAndStatus();
  }

  rows.forEach(r => {
    r.querySelector('input[type="range"]').addEventListener("input", updateAll);
  });

  window.addEventListener("resize", updateAll);
  updateAll();
</script>
</body>
</html>
