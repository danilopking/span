<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Job Design Spans</title>
  <style>
    :root{
      --bg:#f3f4f6;
      --card:#ffffff;
      --text:#111827;
      --muted:#6b7280;
      --line:#6b7280;
      --accent:#b91c1c;
      --ok:#065f46;
      --okbg:#d1fae5;
      --warn:#92400e;
      --warnbg:#ffedd5;
      --border:#e5e7eb;
      --track:#d1d5db;
      --blue:#1d4ed8;
    }

    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: var(--bg);
      color: var(--text);
    }

    .wrap{ max-width: 920px; margin: 0 auto; padding: 18px; }

    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 18px;
      box-shadow: 0 6px 18px rgba(0,0,0,.06);
    }

    h1{ font-size: 22px; margin: 0 0 8px 0; }
    .hint{ color: var(--muted); font-size: 13px; margin-bottom: 14px; }

    /* rows area */
    .rows{
      position: relative;
      padding-top: 8px;
      padding-bottom: 10px;
    }

    .row{
      display: grid;
      grid-template-columns: 220px 1fr 54px;
      gap: 14px;
      align-items: center;
      padding: 14px 0;
    }

    .label{
      font-size: 15px;
      font-weight: 750;
      line-height: 1.2;
    }

    .sliderwrap{ width: 100%; }
    .ends{
      display:flex;
      justify-content: space-between;
      font-size:12px;
      color: var(--muted);
      margin-top: 6px;
    }

    .val{
      width: 54px;
      height: 42px;
      display:flex;
      align-items:center;
      justify-content:center;
      border: 1px solid var(--border);
      border-radius: 12px;
      font-weight: 800;
      background: #fafafa;
    }

    /* Range styling (modern-ish) */
    input[type="range"]{
      width:100%;
      -webkit-appearance: none;
      appearance: none;
      height: 8px;
      border-radius: 999px;
      background: linear-gradient(to right, var(--blue) 0%, var(--blue) 50%, var(--track) 50%, var(--track) 100%);
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: var(--blue);
      border: 2px solid #ffffff;
      box-shadow: 0 2px 10px rgba(0,0,0,.18);
      cursor: pointer;
    }
    input[type="range"]::-moz-range-thumb{
      width: 18px;
      height: 18px;
      border-radius: 999px;
      background: var(--blue);
      border: 2px solid #ffffff;
      box-shadow: 0 2px 10px rgba(0,0,0,.18);
      cursor: pointer;
    }
    input[type="range"]::-moz-range-track{
      height: 8px;
      border-radius: 999px;
      background: var(--track);
    }

    /* overlay only over slider area */
    .overlay{
      position:absolute;
      left: 220px;   /* start where sliders start */
      right: 68px;   /* stop before value boxes */
      top: 8px;
      height: 250px; /* covers 4 rows area */
      pointer-events:none;
      overflow: visible;
    }

    .gapbar{
      display:flex;
      align-items:center;
      gap: 10px;
      margin: 12px 0 0 0;
    }
    .gaplabel{
      color: var(--accent);
      font-weight: 850;
      font-size: 14px;
      white-space: nowrap;
    }
    .gapval{
      font-weight: 900;
      color: var(--accent);
      font-size: 16px;
      white-space: nowrap;
    }
    .gapline{
      height: 2px;
      background: var(--accent);
      flex:1;
      border-radius: 999px;
      position: relative;
    }
    .gapline:before, .gapline:after{
      content:"";
      position:absolute;
      top: 50%;
      width: 0;
      height: 0;
      border-top: 6px solid transparent;
      border-bottom: 6px solid transparent;
      transform: translateY(-50%);
    }
    .gapline:before{ left: -2px; border-right: 10px solid var(--accent); }
    .gapline:after{ right: -2px; border-left: 10px solid var(--accent); }

    .status{
      margin-top: 14px;
      padding: 12px 14px;
      border-radius: 12px;
      font-weight: 800;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .status.ok{ background: var(--okbg); color: var(--ok); }
    .status.warn{ background: var(--warnbg); color: var(--warn); }

    .small{
      font-size: 12px;
      font-weight: 650;
      color: var(--muted);
      margin-top: 7px;
    }

    @media (max-width: 720px){
      .row{ grid-template-columns: 1fr; }
      .overlay{ display:none; }
      .val{ width: 100%; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card">
      <h1>Job Design Spans</h1>
      <div class="hint">Move sliders. The line shows how the job “connects”. Because humans love visual guilt.</div>

      <div class="rows" id="rows">
        <svg class="overlay" id="overlaySvg">
          <polyline id="poly" fill="none" stroke="var(--line)" stroke-width="8" stroke-linecap="round" stroke-linejoin="round" points=""></polyline>
          <circle id="c1" r="8" fill="var(--line)"></circle>
          <circle id="c2" r="8" fill="var(--line)"></circle>
          <circle id="c3" r="8" fill="var(--line)"></circle>
          <circle id="c4" r="8" fill="var(--line)"></circle>
        </svg>

        <div class="row" data-key="control">
          <div class="label">Span of Control</div>
          <div class="sliderwrap">
            <input type="range" min="1" max="10" value="3" step="1" />
            <div class="ends"><span>Few resources</span><span>Many resources</span></div>
          </div>
          <div class="val">3</div>
        </div>

        <div class="row" data-key="accountability">
          <div class="label">Span of Accountability</div>
          <div class="sliderwrap">
            <input type="range" min="1" max="10" value="8" step="1" />
            <div class="ends"><span>Few trade-offs</span><span>Many trade-offs</span></div>
          </div>
          <div class="val">8</div>
        </div>

        <div class="row" data-key="influence">
          <div class="label">Span of Influence</div>
          <div class="sliderwrap">
            <input type="range" min="1" max="10" value="2" step="1" />
            <div class="ends"><span>Within unit</span><span>Across units</span></div>
          </div>
          <div class="val">2</div>
        </div>

        <div class="row" data-key="support">
          <div class="label">Span of Support</div>
          <div class="sliderwrap">
            <input type="range" min="1" max="10" value="5" step="1" />
            <div class="ends"><span>No help</span><span>Others help</span></div>
          </div>
          <div class="val">5</div>
        </div>
      </div>

      <div class="gapbar" title="Simple: Accountability - Control">
        <div class="gaplabel">Entrepreneurial Gap</div>
        <div class="gapline"></div>
        <div class="gapval" id="gapVal">+5</div>
      </div>

      <div class="status ok" id="statusBox">
        <span id="statusIcon">✓</span>
        <span id="statusText">This job is balanced.</span>
      </div>
      <div class="small" id="ruleNote">
        Rule: “balanced” if max difference between spans ≤ 3 (change in code if you want).
      </div>
    </div>
  </div>

<script>
  const rows = [...document.querySelectorAll(".row")];
  const poly = document.getElementById("poly");
  const circles = [1,2,3,4].map(i => document.getElementById("c"+i));
  const gapVal = document.getElementById("gapVal");
  const statusBox = document.getElementById("statusBox");
  const statusIcon = document.getElementById("statusIcon");
  const statusText = document.getElementById("statusText");

  const BALANCE_THRESHOLD = 3;

  function getValues(){
    const map = {};
    rows.forEach(r => {
      const key = r.dataset.key;
      const input = r.querySelector('input[type="range"]');
      map[key] = parseInt(input.value, 10);
    });
    return map;
  }

  function updateValueBoxes(){
    rows.forEach(r => {
      const input = r.querySelector('input[type="range"]');
      r.querySelector(".val").textContent = input.value;
    });
  }

  // paint the "filled" part of the slider track
  function paintTracks(){
    rows.forEach(r => {
      const input = r.querySelector('input[type="range"]');
      const min = parseFloat(input.min || "1");
      const max = parseFloat(input.max || "10");
      const val = parseFloat(input.value);
      const pct = ((val - min) / (max - min)) * 100;
      input.style.background = `linear-gradient(to right, var(--blue) 0%, var(--blue) ${pct}%, var(--track) ${pct}%, var(--track) 100%)`;
    });
  }

  function updatePolyline(){
    const overlay = document.getElementById("overlaySvg");
    const overlayRect = overlay.getBoundingClientRect();

    const w = overlayRect.width;
    const h = overlayRect.height;
    overlay.setAttribute("width", w);
    overlay.setAttribute("height", h);
    overlay.setAttribute("viewBox", `0 0 ${w} ${h}`);

    const order = ["control","accountability","influence","support"];

    const points = order.map((key) => {
      const row = rows.find(r => r.dataset.key === key);
      const input = row.querySelector('input[type="range"]');

      const min = parseFloat(input.min || "1");
      const max = parseFloat(input.max || "10");
      const val = parseFloat(input.value);
      const t = (val - min) / (max - min);

      const inputRect = input.getBoundingClientRect();

      // thumb radius approximation, helps align with the visual thumb
      const thumb = 18;
      const x = (inputRect.left - overlayRect.left) + thumb + t * (inputRect.width - 2*thumb);

      const y = (inputRect.top - overlayRect.top) + inputRect.height / 2;

      return {x, y};
    });

    poly.setAttribute("points", points.map(p => `${p.x},${p.y}`).join(" "));
    points.forEach((p, i) => {
      circles[i].setAttribute("cx", p.x);
      circles[i].setAttribute("cy", p.y);
    });
  }

  function updateGapAndStatus(){
    const v = getValues();
    const gap = v.accountability - v.control;
    gapVal.textContent = (gap >= 0 ? "+" : "") + gap;

    const arr = Object.values(v);
    const max = Math.max(...arr);
    const min = Math.min(...arr);
    const spread = max - min;

    if (spread <= BALANCE_THRESHOLD){
      statusBox.classList.remove("warn");
      statusBox.classList.add("ok");
      statusIcon.textContent = "✓";
      statusText.textContent = "This job is balanced.";
    } else {
      statusBox.classList.remove("ok");
      statusBox.classList.add("warn");
      statusIcon.textContent = "⚠";
      statusText.textContent = "This job looks unbalanced (spans are too far apart).";
    }
  }

  function updateAll(){
    updateValueBoxes();
    paintTracks();
    updatePolyline();
    updateGapAndStatus();
  }

  rows.forEach(r => {
    r.querySelector('input[type="range"]').addEventListener("input", updateAll);
  });

  window.addEventListener("resize", updateAll);
  updateAll();
</script>
</body>
</html>
